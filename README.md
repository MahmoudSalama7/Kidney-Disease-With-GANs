![image](https://github.com/user-attachments/assets/7ee35b88-1148-41a5-b46e-d3275c2d6423)

# Kidney Disease Classification Using DCGAN

## Overview

This project implements a **Deep Convolutional Generative Adversarial Network (DCGAN)** using PyTorch to analyze and classify CT images related to kidney disease. The objective is to generate synthetic CT images of kidneys, and potentially use those generated images to assist in improving kidney disease detection (e.g., cyst, tumor, stone, or normal kidneys).

### Key Components:
- **Generator**: Produces synthetic kidney images from random noise.
- **Discriminator**: Distinguishes between real kidney images from the dataset and fake images generated by the generator.

## Dataset

The project utilizes a CT Kidney dataset available from Kaggle, which contains images labeled into four categories:
- Normal
- Cyst
- Tumor
- Stone

### Dataset URL:
[Kaggle CT Kidney Dataset](https://www.kaggle.com/datasets/nazmul0087/ct-kidney-dataset-normal-cyst-tumor-and-stone)

### Dataset Structure:
```
/data
  /Normal
    - image1.jpg
    - image2.jpg
    ...
  /Cyst
    - image1.jpg
    - image2.jpg
    ...
  /Tumor
    - image1.jpg
    - image2.jpg
    ...
  /Stone
    - image1.jpg
    - image2.jpg
    ...
```

The dataset includes CT scan images for normal kidneys, as well as those affected by cysts, tumors, or stones.

## Requirements

- Python 3.7+
- PyTorch 1.7+
- torchvision
- matplotlib
- numpy
- CUDA (optional, for GPU acceleration)

### Install dependencies:
```bash
pip install torch torchvision matplotlib numpy
```

## Model Architecture

### Generator:
- Converts random noise (`nz`-dimensional latent vector) into realistic kidney CT images.
- Uses transposed convolutional layers to upsample the noise into image-like structures.
- Batch normalization and ReLU activations are applied at each layer, with Tanh as the final activation.

### Discriminator:
- Takes kidney images (real or fake) as input.
- Convolutional layers downsample the images, with BatchNorm and LeakyReLU activations.
- Outputs a scalar representing the probability of the image being real or fake.

### Key Parameters:
- `nc`: Number of channels in the input images (e.g., 3 for RGB images).
- `nz`: Size of the latent noise vector.
- `ngf`: Number of filters in the generator.
- `ndf`: Number of filters in the discriminator.
- `lr`: Learning rate for the optimizer.
- `beta1`: Beta1 hyperparameter for Adam optimizer.
- `batch_size`: Size of each batch.
- `image_size`: Resolution to which images are resized (e.g., 64x64).

## Training

### Running the Training Script:

1. Download the CT Kidney dataset from Kaggle and organize it in the specified folder structure.
2. Set the `dataroot` variable in the script to point to the dataset directory.

```bash
python train_dcgan_kidney.py
```

This will:
- Load the kidney CT dataset.
- Initialize and train the generator and discriminator models over the specified number of epochs.

### Training Process:

The training process involves:
1. **Updating the Discriminator**: To distinguish real kidney images from fake ones.
2. **Updating the Generator**: To create more realistic fake kidney images that can fool the discriminator.

### Example of Output Logs:
```
[2/35][0/41]	Loss_D: 1.7993	Loss_G: 2.1801	D(x): 0.4421	D(G(z)): 0.4775 / 0.1783
[3/35][0/41]	Loss_D: 1.7676	Loss_G: 1.9373	D(x): 0.4946	D(G(z)): 0.5415 / 0.1963
```
- **Loss_D**: Discriminator loss.
- **Loss_G**: Generator loss.
- **D(x)**: Discriminator's confidence that the real images are real.
- **D(G(z))**: Discriminator's confidence that generated images are real.

### Hyperparameters:
- `num_epochs`: Number of training epochs (default: 35).
- `batch_size`: Size of each batch (default: 128).
- `lr`: Learning rate for Adam optimizer (default: 0.0002).
- `beta1`: Beta1 parameter for Adam optimizer (default: 0.5).

## Generated Images

During training, the generator creates synthetic kidney images from random noise vectors. These images can be visualized periodically to monitor the quality of generated images over time.

### Example of Generated Images:

![Generated Images](output_image_sample.png)

## Customization

### Modifying the Dataset:
- Update the `dataroot` variable in the script to point to your kidney dataset directory.

### Modifying Hyperparameters:
You can adjust various parameters such as:
- `num_epochs`
- `batch_size`
- `ngf`, `ndf`, `nz` (network architecture settings)
- `lr`, `beta1` (learning rate and optimizer parameters)

## Usage

### Training the DCGAN Model for Kidney Disease:

```bash
python train_dcgan_kidney.py
```

Make sure to configure the dataset location and adjust any hyperparameters before running the training script.

## References

- [DCGAN Paper](https://arxiv.org/abs/1511.06434)
- [PyTorch DCGAN Tutorial](https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html)
- [Kaggle CT Kidney Dataset](https://www.kaggle.com/datasets/nazmul0087/ct-kidney-dataset-normal-cyst-tumor-and-stone)

